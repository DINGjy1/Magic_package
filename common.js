(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[3],{0:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(20),r=n(21),o=n(14),a=n(10),c=n.n(a),s=function(){function e(){Object(i["a"])(this,e)}return Object(r["a"])(e,null,[{key:"getScreenHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=c.a.getSystemInfoSync();return e&&t.windowHeight===t.screenHeight?t.screenHeight-t.statusBarHeight-this.getWechatCustomNavigationBarHeight():t.windowHeight}},{key:"getWechatCustomNavigationBarHeight",value:function(){return"android"===this.platform?48:this.baseNavigationBarHeight}},{key:"isEnterpriseVersion",value:function(){return"wxwork"===this.systemInfo.environment&&!1}},{key:"getLoginFunc",value:function(){return this.isEnterpriseVersion()?c.a.qy.login:c.a.login}},{key:"getLoginGqlRootField",value:function(){return this.isEnterpriseVersion()?"loginWithWxworkMiniApp":"loginWithWechatMiniApp"}},{key:"getCheckSessionFunc",value:function(){return this.isEnterpriseVersion()?c.a.qy.checkSession:c.a.checkSession}}]),e}();Object(o["a"])(s,"baseScreenWidth",375),Object(o["a"])(s,"baseStatusBarHeight",20),Object(o["a"])(s,"baseNavigationBarHeight",44),Object(o["a"])(s,"baseTabBarHeight",49),Object(o["a"])(s,"systemInfo",c.a.getSystemInfoSync()),Object(o["a"])(s,"platform",s.systemInfo.platform),Object(o["a"])(s,"statusBarHeight",s.systemInfo.statusBarHeight),Object(o["a"])(s,"screenWidth",s.systemInfo.windowWidth),Object(o["a"])(s,"dpr",s.systemInfo.pixelRatio),Object(o["a"])(s,"ratio",s.screenWidth/s.baseScreenWidth)},12:function(e,t,n){"use strict";n.d(t,"n",(function(){return h})),n.d(t,"m",(function(){return d})),n.d(t,"p",(function(){return v})),n.d(t,"o",(function(){return b})),n.d(t,"i",(function(){return y})),n.d(t,"h",(function(){return p})),n.d(t,"l",(function(){return g})),n.d(t,"b",(function(){return m})),n.d(t,"k",(function(){return O})),n.d(t,"j",(function(){return k})),n.d(t,"e",(function(){return j})),n.d(t,"d",(function(){return w})),n.d(t,"a",(function(){return T})),n.d(t,"c",(function(){return I})),n.d(t,"g",(function(){return E})),n.d(t,"f",(function(){return C}));var i=n(11),r=n(30),o=n(29),a=n(3),c=n.n(a),s=n(50),u=(n(42),n(53)),l=n(18),h=function(e){return null===e||void 0===e},d=function(e){if(h(e))return!0;try{return 0===e.length}catch(e){return!1}},f=function(e){return e&&"object"===Object(o["a"])(e)&&"number"===typeof e.length&&e.push&&e.pop},v=function(e){return"string"===typeof e},b=function(e){return Object(u["isObject"])(e)},y=function e(t){return f(t)?"[".concat(t.map((function(t){return e(t)})).join(","),"]"):b(t)?"{".concat(Object.entries(t).map((function(t){var n=Object(r["a"])(t,2),i=n[0],o=n[1];return"".concat(i,": ").concat(e(o))})).join(","),"}"):JSON.stringify(t)},p=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(null===t||void 0===t)return i;if(n.length>r){var o=n[r];return null==o||void 0===o?i:e(t[o],n,i,r+1)}return t},g=function(e){try{return JSON.parse(e)}catch(e){return}},m=function(e,t,n){return"FZ_QUERY_NULL_EXP_FZ"===n?"{".concat(e,": { ").concat(t,": null }}"):h(n)?"{}":"{".concat(e,": { ").concat(t,": ").concat(JSON.stringify(n)," }}")},O=function(e){return h(e)?e:Number(e)},k=function(e){return null===e||"number"===typeof e?e:JSON.stringify(e)},j=function(e){return e.value},w=function(){var e=Object(i["a"])(c.a.mark((function e(t){var n,i,r,o,a;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="IMAGE"===e.t0||"VIDEO"===e.t0?3:"IMAGE_LIST"===e.t0?11:"LIST_OF_IMAGE"===e.t0?25:39;break;case 3:if(!t.promise){e.next=9;break}return e.next=6,t.promise;case 6:e.t1=e.sent,e.next=10;break;case 9:e.t1=t.value;case 10:return e.abrupt("return",e.t1);case 11:if(t.value&&t.value.length){e.next=13;break}return e.abrupt("return",null);case 13:n=[],i=0;case 15:if(!(i<t.value.length)){e.next=24;break}return e.t2=n,e.next=19,l["a"].uploadPromises[t.value[i].url];case 19:e.t3=e.sent.id,e.t2.push.call(e.t2,e.t3);case 21:i++,e.next=15;break;case 24:return e.abrupt("return",n);case 25:if(t.value&&t.value.length){e.next=27;break}return e.abrupt("return",null);case 27:r=[],o=0;case 29:if(!(o<t.value.length)){e.next=38;break}return a=t.value[o],e.next=33,l["a"].uploadPromises[a.url];case 33:a.id=e.sent.id,r.push(a);case 35:o++,e.next=29;break;case 38:return e.abrupt("return",r);case 39:return e.abrupt("return",t.promise?t.promise:t.value);case 40:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(e,t){var n={item:e,otherCellLevelData:t};return n},I=function(e){var t;return e&&e.longitude&&e.latitude?t=s["a"].transform([e.longitude,e.latitude],s["a"].GCJ02,s["a"].WGS84):e&&e.coordinates&&2===e.coordinates.length&&(t=e.coordinates),t?"{type: Point, coordinates: [".concat(t,"]}"):"null"},E=function(e){return"string"===typeof e?e:null===e||void 0===e?void 0:e.url},C=function(e){return h(e)?null:"string"===typeof e?{url:e}:e}},18:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(21),r=n(20),o=n(14),a=Object(i["a"])((function e(){Object(r["a"])(this,e)}));Object(o["a"])(a,"launchArgs",{}),Object(o["a"])(a,"screenData",{}),Object(o["a"])(a,"audioData",{}),Object(o["a"])(a,"uploadPromises",{}),Object(o["a"])(a,"requestStatus",{})},22:function(e,t,n){"use strict";n.d(t,"b",(function(){return ie}));var i=n(11),r=n(15),o=n(3),a=n.n(o),c=n(234),s=n(44),u=n(233),l=n(238),h="https://zion-app.functorz.com/GQoonOK2Rdv/zero/5bRlXJn7QA6/api/graphql-v2",d="wss://zion-app.functorz.com/GQoonOK2Rdv/zero/5bRlXJn7QA6/api/graphql-subscription",f=n(24),v=n(25),b=n(7),y=n(5),p=n(10),g=n.n(p),m=n(228),O=n.n(m),k=n(64),j=n(33),w=n(20),T=n(21),I=n(14),E=n(78),C=n.n(E),M=n(229),S=n(67),N=n(231),A=n(66),L=n(69),x="graphql-ws",R=x,_=1e3,G=3e4,P=Object(T["a"])((function e(){Object(w["a"])(this,e)}));Object(I["a"])(P,"GQL_CONNECTION_INIT","connection_init"),Object(I["a"])(P,"GQL_CONNECTION_ACK","connection_ack"),Object(I["a"])(P,"GQL_CONNECTION_ERROR","connection_error"),Object(I["a"])(P,"GQL_CONNECTION_KEEP_ALIVE","ka"),Object(I["a"])(P,"GQL_CONNECTION_TERMINATE","connection_terminate"),Object(I["a"])(P,"GQL_START","start"),Object(I["a"])(P,"GQL_DATA","data"),Object(I["a"])(P,"GQL_ERROR","error"),Object(I["a"])(P,"GQL_COMPLETE","complete"),Object(I["a"])(P,"GQL_STOP","stop"),Object(I["a"])(P,"GQL_CONTROL_MESSAGE_TYPES",[P.GQL_CONNECTION_INIT,P.GQL_CONNECTION_TERMINATE]);var Q=function(){function e(t,n,i,r){Object(w["a"])(this,e),Object(I["a"])(this,"client",void 0),Object(I["a"])(this,"operations",void 0),Object(I["a"])(this,"url",void 0),Object(I["a"])(this,"connectionAcked",void 0),Object(I["a"])(this,"nextOperationId",void 0),Object(I["a"])(this,"connectionParams",void 0),Object(I["a"])(this,"minWsTimeout",void 0),Object(I["a"])(this,"wsTimeout",void 0),Object(I["a"])(this,"unsentMessagesQueue",void 0),Object(I["a"])(this,"reconnect",void 0),Object(I["a"])(this,"reconnecting",void 0),Object(I["a"])(this,"reconnectionAttempts",void 0),Object(I["a"])(this,"backoff",void 0),Object(I["a"])(this,"connectionCallback",void 0),Object(I["a"])(this,"eventEmitter",void 0),Object(I["a"])(this,"lazy",void 0),Object(I["a"])(this,"inactivityTimeout",void 0),Object(I["a"])(this,"inactivityTimeoutId",void 0),Object(I["a"])(this,"closedByUser",void 0),Object(I["a"])(this,"wsImpl",void 0),Object(I["a"])(this,"wsProtocols",void 0),Object(I["a"])(this,"wasKeepAliveReceived",void 0),Object(I["a"])(this,"tryReconnectTimeoutId",void 0),Object(I["a"])(this,"checkConnectionIntervalId",void 0),Object(I["a"])(this,"maxConnectTimeoutId",void 0),Object(I["a"])(this,"middlewares",void 0),Object(I["a"])(this,"maxConnectTimeGenerator",void 0),Object(I["a"])(this,"wsOptionArguments",void 0);var o=n||{},a=o.connectionCallback,c=void 0===a?void 0:a,s=o.connectionParams,u=void 0===s?{}:s,l=o.minTimeout,h=void 0===l?_:l,d=o.timeout,f=void 0===d?G:d,v=o.reconnect,b=void 0!==v&&v,y=o.reconnectionAttempts,p=void 0===y?1/0:y,g=o.lazy,m=void 0!==g&&g,O=o.inactivityTimeout,k=void 0===O?0:O,j=o.wsOptionArguments,T=void 0===j?[]:j;if(this.wsImpl=i,!this.wsImpl)throw new Error("must provide wsImpl");this.wsProtocols=r||R,this.connectionCallback=c,this.url=t,this.connectionAcked=!1,this.operations={},this.nextOperationId=0,this.minWsTimeout=h,this.wsTimeout=f,this.unsentMessagesQueue=[],this.reconnect=b,this.reconnecting=!1,this.reconnectionAttempts=p,this.lazy=!!m,this.inactivityTimeout=k,this.closedByUser=!1,this.backoff=new C.a({jitter:.5}),this.eventEmitter=new M["EventEmitter"],this.middlewares=[],this.client=null,this.maxConnectTimeGenerator=this.createMaxConnectTimeGenerator(),this.connectionParams=this.getConnectionParams(u),this.wsOptionArguments=T,this.lazy||this.connect()}return Object(T["a"])(e,[{key:"status",get:function(){return null===this.client?this.wsImpl.CLOSED:this.client.readyState}},{key:"close",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.clearInactivityTimeout(),null!==this.client&&(this.closedByUser=t,e&&(this.clearCheckConnectionInterval(),this.clearMaxConnectTimeout(),this.clearTryReconnectTimeout(),this.unsubscribeAll(),this.sendMessage(void 0,P.GQL_CONNECTION_TERMINATE,null)),this.client.close(),this.client.onopen=null,this.client.onclose=null,this.client.onerror=null,this.client.onmessage=null,this.client=null,this.connectionAcked=!1,this.eventEmitter.emit("disconnected"),e||this.tryReconnect())}},{key:"request",value:function(e){var t,n,i=this.getObserver.bind(this),r=this.executeOperation.bind(this),o=this.unsubscribe.bind(this);return this.clearInactivityTimeout(),t={},Object(I["a"])(t,A["a"],(function(){return this})),Object(I["a"])(t,"subscribe",(function(t,a,c){var s=i(t,a,c);return n=r(e,(function(e,t){null===e&&null===t?s.complete&&s.complete():e?s.error&&s.error(e[0]):s.next&&s.next(t)})),{unsubscribe:function(){n&&(o(n),n=null)}}})),t}},{key:"on",value:function(e,t,n){var i=this.eventEmitter.on(e,t,n);return function(){i.off(e,t,n)}}},{key:"onConnected",value:function(e,t){return this.on("connected",e,t)}},{key:"onConnecting",value:function(e,t){return this.on("connecting",e,t)}},{key:"onDisconnected",value:function(e,t){return this.on("disconnected",e,t)}},{key:"onReconnected",value:function(e,t){return this.on("reconnected",e,t)}},{key:"onReconnecting",value:function(e,t){return this.on("reconnecting",e,t)}},{key:"onError",value:function(e,t){return this.on("error",e,t)}},{key:"unsubscribeAll",value:function(){var e=this;Object.keys(this.operations).forEach((function(t){e.unsubscribe(t)}))}},{key:"applyMiddlewares",value:function(e){var t=this;return new Promise((function(n,i){var r=function(t,r){var o=function o(a){if(a)i(a);else if(t.length>0){var c=t.shift();c&&c.applyMiddleware.apply(r,[e,o])}else n(e)};o()};r(Object(j["a"])(t.middlewares),t)}))}},{key:"use",value:function(e){var t=this;return e.forEach((function(e){if("function"!==typeof e.applyMiddleware)throw new Error("Middleware must implement the applyMiddleware function.");t.middlewares.push(e)})),this}},{key:"getConnectionParams",value:function(e){return function(){return new Promise((function(t,n){if("function"===typeof e)try{return t(e.call(null))}catch(e){return n(e)}t(e)}))}}},{key:"executeOperation",value:function(e,t){var n=this;null===this.client&&this.connect();var i=this.generateOperationId();return this.operations[i]={options:e,handler:t},this.applyMiddlewares(e).then((function(e){n.checkOperationOptions(e,t),n.operations[i]&&(n.operations[i]={options:e,handler:t},n.sendMessage(i,P.GQL_START,e))})).catch((function(e){n.unsubscribe(i),t(n.formatErrors(e))})),i}},{key:"getObserver",value:function(e,t,n){return"function"===typeof e?{next:function(t){return e(t)},error:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return t&&t(e)})),complete:function(){return n&&n()}}:e}},{key:"createMaxConnectTimeGenerator",value:function(){var e=this.minWsTimeout,t=this.wsTimeout;return new C.a({min:e,max:t,factor:1.2})}},{key:"clearCheckConnectionInterval",value:function(){this.checkConnectionIntervalId&&(clearInterval(this.checkConnectionIntervalId),this.checkConnectionIntervalId=null)}},{key:"clearMaxConnectTimeout",value:function(){this.maxConnectTimeoutId&&(clearTimeout(this.maxConnectTimeoutId),this.maxConnectTimeoutId=null)}},{key:"clearTryReconnectTimeout",value:function(){this.tryReconnectTimeoutId&&(clearTimeout(this.tryReconnectTimeoutId),this.tryReconnectTimeoutId=null)}},{key:"clearInactivityTimeout",value:function(){this.inactivityTimeoutId&&(clearTimeout(this.inactivityTimeoutId),this.inactivityTimeoutId=null)}},{key:"setInactivityTimeout",value:function(){var e=this;this.inactivityTimeout>0&&0===Object.keys(this.operations).length&&(this.inactivityTimeoutId=setTimeout((function(){0===Object.keys(e.operations).length&&e.close()}),this.inactivityTimeout))}},{key:"checkOperationOptions",value:function(e,t){var n=e.query,i=e.variables,r=e.operationName;if(!n)throw new Error("Must provide a query.");if(!t)throw new Error("Must provide an handler.");if(!Object(L["b"])(n)&&!Object(N["getOperationAST"])(n,r)||r&&!Object(L["b"])(r)||i&&!Object(L["a"])(i))throw new Error("Incorrect option types. query must be a string or a document,`operationName` must be a string, and `variables` must be an object.")}},{key:"buildMessage",value:function(e,t,n){var i=n&&n.query?Object(r["a"])(Object(r["a"])({},n),{},{query:"string"===typeof n.query?n.query:Object(S["print"])(n.query)}):n;return{id:e,type:t,payload:i}}},{key:"formatErrors",value:function(e){return Array.isArray(e)?e:e&&e.errors?this.formatErrors(e.errors):e&&e.message?[e]:[{name:"FormatedError",message:"Unknown error",originalError:e}]}},{key:"sendMessage",value:function(e,t,n){this.sendMessageRaw(this.buildMessage(e,t,n),this.isApolloControlMessageType(t))}},{key:"sendMessageRaw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(this.status){case this.wsImpl.OPEN:if(t||this.connectionAcked){var n=JSON.stringify(e);this.client.send(n)}else this.unsentMessagesQueue.push(e);break;case this.wsImpl.CONNECTING:this.unsentMessagesQueue.push(e);break;default:this.reconnecting||this.eventEmitter.emit("error",new Error("".concat("A message was not sent because socket is not connected, is closing or is already closed. Message was: ").concat(JSON.stringify(e))))}}},{key:"isApolloControlMessageType",value:function(e){return P.GQL_CONTROL_MESSAGE_TYPES.includes(e)}},{key:"generateOperationId",value:function(){return String(++this.nextOperationId)}},{key:"tryReconnect",value:function(){var e=this;if(this.reconnect&&!(this.backoff.attempts>=this.reconnectionAttempts)){this.reconnecting||(Object.keys(this.operations).forEach((function(t){e.unsentMessagesQueue.push(e.buildMessage(t,P.GQL_START,e.operations[t].options))})),this.reconnecting=!0,this.connectionAcked=!1),this.clearTryReconnectTimeout();var t=this.backoff.duration();this.tryReconnectTimeoutId=setTimeout((function(){e.connect()}),t)}}},{key:"flushUnsentMessagesQueue",value:function(){var e=this;this.unsentMessagesQueue.forEach((function(t){e.sendMessageRaw(t)})),this.unsentMessagesQueue=[]}},{key:"checkConnection",value:function(){this.wasKeepAliveReceived?this.wasKeepAliveReceived=!1:this.reconnecting||this.close(!1,!0)}},{key:"checkMaxConnectTimeout",value:function(){var e=this;this.clearMaxConnectTimeout(),this.maxConnectTimeoutId=setTimeout((function(){e.status!==e.wsImpl.OPEN&&(e.reconnecting=!0,e.close(!1,!0))}),this.maxConnectTimeGenerator.duration())}},{key:"connect",value:function(){var e=this;this.client=Object(k["a"])(this.wsImpl,[this.url,this.wsProtocols].concat(Object(j["a"])(this.wsOptionArguments))),this.connectionAcked=!1,this.checkMaxConnectTimeout(),this.client.onopen=Object(i["a"])(a.a.mark((function t(){var n;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("subscription client onopen",e.client.socketTaskId),e.status!==e.wsImpl.OPEN){t.next=16;break}return e.clearMaxConnectTimeout(),e.closedByUser=!1,e.eventEmitter.emit(e.reconnecting?"reconnecting":"connecting"),t.prev=5,t.next=8,e.connectionParams();case 8:n=t.sent,e.sendMessage(void 0,P.GQL_CONNECTION_INIT,n),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](5),e.sendMessage(void 0,P.GQL_CONNECTION_ERROR,t.t0),e.flushUnsentMessagesQueue();case 16:case"end":return t.stop()}}),t,null,[[5,12]])}))),this.client.onclose=function(){e.closedByUser||e.close(!1,!1)},this.client.onerror=function(t){e.eventEmitter.emit("error",t)},this.client.onmessage=function(t){var n=t.data;e.processReceivedData(n)}}},{key:"processReceivedData",value:function(e){var t,n;try{t=JSON.parse(e),n=t.id}catch(t){throw new Error("Message must be JSON-parseable. Got: ".concat(e))}if(-1===[P.GQL_DATA,P.GQL_COMPLETE,P.GQL_ERROR].indexOf(t.type)||this.operations[n])switch(t.type){case P.GQL_CONNECTION_ERROR:this.connectionAcked=!1,this.connectionCallback&&this.connectionCallback(t.payload);break;case P.GQL_CONNECTION_ACK:this.eventEmitter.emit(this.reconnecting?"reconnected":"connected",t.payload),this.reconnecting=!1,this.backoff.reset(),this.maxConnectTimeGenerator.reset(),this.connectionAcked=!0,this.flushUnsentMessagesQueue(),this.connectionCallback&&this.connectionCallback();break;case P.GQL_COMPLETE:var i=this.operations[n].handler;delete this.operations[n],i.call(this,null,null);break;case P.GQL_ERROR:this.operations[n].handler(this.formatErrors(t.payload),null),delete this.operations[n];break;case P.GQL_DATA:var o=t.payload.errors?Object(r["a"])(Object(r["a"])({},t.payload),{},{errors:this.formatErrors(t.payload.errors)}):t.payload;this.operations[n].handler(null,o);break;case P.GQL_CONNECTION_KEEP_ALIVE:var a="undefined"===typeof this.wasKeepAliveReceived;this.wasKeepAliveReceived=!0,a&&this.checkConnection(),this.checkConnectionIntervalId&&(clearInterval(this.checkConnectionIntervalId),this.checkConnection()),this.checkConnectionIntervalId=setInterval(this.checkConnection.bind(this),this.wsTimeout);break;default:throw new Error("Invalid message type!")}else this.unsubscribe(n)}},{key:"unsubscribe",value:function(e){this.operations[e]&&(delete this.operations[e],this.setInactivityTimeout(),this.sendMessage(e,P.GQL_STOP,void 0))}}]),e}(),q=n(41),J=n(38),B=n(39),D=n(65),V=1,z=function(e){Object(J["a"])(n,e);var t=Object(B["a"])(n);function n(e,i){var r;Object(w["a"])(this,n),r=t.call(this),Object(I["a"])(Object(q["a"])(r),"protocol",void 0),Object(I["a"])(Object(q["a"])(r),"url",void 0),Object(I["a"])(Object(q["a"])(r),"binaryType",void 0),Object(I["a"])(Object(q["a"])(r),"bufferedAmount",void 0),Object(I["a"])(Object(q["a"])(r),"extensions",void 0),Object(I["a"])(Object(q["a"])(r),"socketTask",void 0),Object(I["a"])(Object(q["a"])(r),"socketTaskId",void 0),Object(I["a"])(Object(q["a"])(r),"listenersByType",void 0),r.url=e,r.protocol="graphql-ws",r.extensions="",r.binaryType="blob",r.listenersByType=new Map;var o={url:r.url,protocols:[r.protocol],success:function(e){console.log("connected",e),r.socketTaskId=e.socketTaskId;var t=r.listenersByType.get("open");null===t||void 0===t||t.forEach((function(t){return t(e)}))}};return r.socketTask=wx.connectSocket(o),r.socketTask.onClose((function(e){console.log("onClose",r.socketTaskId,r.socketTask.readyState);var t=r.listenersByType.get("close");null===t||void 0===t||t.forEach((function(t){return t(e)}))})),r.socketTask.onError((function(e){console.log("error",r.socketTaskId,r.socketTask.readyState,e);var t=r.listenersByType.get("error");null===t||void 0===t||t.forEach((function(t){return t(e)}))})),r.socketTask.onMessage((function(e){var t=r.listenersByType.get("message");null===t||void 0===t||t.forEach((function(t){return t(e)}))})),r.socketTask.onOpen((function(e){console.log("opened",r.socketTaskId,r.socketTask.readyState,e);var t=r.listenersByType.get("open");null===t||void 0===t||t.forEach((function(t){return t(e)}))})),r}return Object(T["a"])(n,[{key:"CLOSED",get:function(){return 3}},{key:"CLOSING",get:function(){return 2}},{key:"CONNECTING",get:function(){return 0}},{key:"OPEN",get:function(){return 1}},{key:"readyState",get:function(){return this.socketTask.readyState}},{key:"dispatchEvent",value:function(e){throw new Error("Method not implemented.")}},{key:"onclose",get:function(){throw new Error("Method not implemented.")},set:function(e){e?this.listenersByType.set("close",new Set([e])):this.listenersByType.delete("close")}},{key:"onerror",get:function(){throw new Error("Method not implemented.")},set:function(e){e?this.listenersByType.set("error",new Set([e])):this.listenersByType.delete("error")}},{key:"onmessage",get:function(){throw new Error("Method not implemented.")},set:function(e){e?this.listenersByType.set("message",new Set([e])):this.listenersByType.delete("message")}},{key:"onopen",get:function(){throw new Error("Method not implemented.")},set:function(e){e?(this.listenersByType.set("open",new Set([e])),this.readyState===V&&e.apply(this)):this.listenersByType.delete("open")}},{key:"ping",value:function(e,t,n){console.log("ping",e,t,n)}},{key:"pong",value:function(e,t,n){console.log("pong",e,t,n)}},{key:"close",value:function(e,t){var n=this;console.log("closing ws",this.socketTaskId,this.socketTask.readyState),this.socketTask.close({code:e,reason:t,success:function(e){console.log("ws closing success",n.socketTaskId,n.readyState,e)},fail:function(e){console.log("ws closing error",n.socketTaskId,n.readyState,e)}})}},{key:"send",value:function(e){e.toString().indexOf("subscription")>=0?console.log("send subscription message",this.socketTaskId,this.socketTask.readyState,e):console.log("send",this.socketTaskId,this.socketTask.readyState,e);var t=e;this.socketTask.send({data:t})}},{key:"addEventListener",value:function(e,t,n){console.log("addEventListener",e,t);var i=this.listenersByType.get(e);i||(i=new Set),i.add(t)}},{key:"removeEventListener",value:function(e,t,n){var i=this.listenersByType.get(e);i?i.delete(t):i=new Set}}]),n}(D["EventEmitter2"]);Object(I["a"])(z,"CLOSED",3),Object(I["a"])(z,"CLOSING",2),Object(I["a"])(z,"CONNECTING",0),Object(I["a"])(z,"OPEN",1);var X=function(e){Object(J["a"])(n,e);var t=Object(B["a"])(n);function n(e){var i;return Object(w["a"])(this,n),i=t.call(this),Object(I["a"])(Object(q["a"])(i),"subscriptionClient",void 0),i.subscriptionClient=e,i}return Object(T["a"])(n,[{key:"request",value:function(e){return this.subscriptionClient.request(e)}}]),n}(s["a"]),W=n(0),U=new s["a"]((function(e,t){return e.setContext((function(e){var t=e.headers||[];return{headers:Object(r["a"])(Object(r["a"])({},t),{},{Authorization:"Bearer "+f["a"].token})}})),t(e)})),F=Object(s["c"])([U,new u["a"]({uri:h,fetch:O.a})]),K=new Q(d,{lazy:!0,reconnect:!0,connectionParams:function(){var e={Authorization:"Bearer "+f["a"].token};return{authToken:f["a"].token,headers:e}}},z);b["a"].on("GLOBAL_REFRESH",(function(){return K.close()}));var Y=new X(K),H=Object(s["e"])((function(e){var t=e.query,n=Object(v["j"])(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),Y,F),Z=new c["a"]({link:H,cache:new l["a"],defaultOptions:{watchQuery:{fetchPolicy:"no-cache",errorPolicy:"ignore"},query:{fetchPolicy:"no-cache",errorPolicy:"all"}}}),$=function(){var e=Object(i["a"])(a.a.mark((function e(t,n){var o,c,s,u,l,h;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("result ->",t),o=n.handlerParams,c=n.onSuccess,s=n.onFailure,u=n.onFinally,l=n.onShowToast,h=n.onRequestStatusChange,Object(y["p"])(Object(i["a"])(a.a.mark((function e(){return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.errors&&t.errors.length){null===h||void 0===h||h("business-error");try{null===s||void 0===s||s()}finally{null===u||void 0===u||u()}null===l||void 0===l||l(t.errors.map((function(e){return e.message})).join("\n")),te(Object(r["a"])(Object(r["a"])({},o),{},{errorMessage:t.errors.map((function(e){return e.message})).join("\n")}))}else if(t.data){null===h||void 0===h||h("successful");try{null===c||void 0===c||c(t)}finally{null===u||void 0===u||u()}}else{null===h||void 0===h||h("business-error");try{null===s||void 0===s||s()}finally{null===u||void 0===u||u()}null===l||void 0===l||l("unknown error"),te(Object(r["a"])(Object(r["a"])({},o),{},{errorMessage:"unknown error"}))}case 1:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ee=function(){var e=Object(i["a"])(a.a.mark((function e(t,n){var i,o,c,s,u;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("error ->",t),i=n.handlerParams,o=n.onFailure,c=n.onFinally,s=n.onShowToast,u=n.onRequestStatusChange,t.graphQLErrors&&t.graphQLErrors.length){null===u||void 0===u||u("business-error");try{null===o||void 0===o||o()}finally{null===c||void 0===c||c()}null===s||void 0===s||s(t.graphQLErrors.map((function(e){return e.message})).join("\n")),te(Object(r["a"])(Object(r["a"])({},i),{},{errorMessage:t.graphQLErrors.map((function(e){return e.message})).join("\n")}))}else if(t.networkError&&"ServerParseError"===t.networkError.name){null===u||void 0===u||u("network-error");try{null===o||void 0===o||o()}finally{null===c||void 0===c||c()}null===s||void 0===s||s("network error"),te(Object(r["a"])(Object(r["a"])({},i),{},{errorMessage:JSON.stringify(t.networkError)}))}else{null===u||void 0===u||u("network-error");try{null===o||void 0===o||o()}finally{null===c||void 0===c||c()}null===s||void 0===s||s("unknown error"),te(Object(r["a"])(Object(r["a"])({},i),{},{errorMessage:"unknown error"}))}case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),te=function(e){g.a.request({url:"https://error-collector.functorz.com/add/project_error_log",method:"POST",header:{"Content-Type":"application/json","x-project-auth":"5bRlXJn7QA6"},data:{projectExId:"5bRlXJn7QA6",stage:"RUNTIME",interactiveType:"RUNTIME",platform:"WECHAT_MINIPROGRAM",message:e.errorMessage,detail:{url:e.url,gql:ie(e.gql),variable:e.variables||{},account:f["a"].account,appVersion:"v23060901",systemInfo:W["a"].systemInfo}}})},ne={query:function(e,t){return Z.query(e).then((function(n){return $(n,Object(r["a"])(Object(r["a"])({},t),{},{handlerParams:{url:h,gql:e.query}}))}),(function(n){return ee(n,Object(r["a"])(Object(r["a"])({},t),{},{handlerParams:{url:h,gql:e.query}}))}))},subscribe:function(e,t){return Z.subscribe(e).subscribe((function(n){return $(n,Object(r["a"])(Object(r["a"])({},t),{},{handlerParams:{url:d,gql:e.query}}))}))},mutate:function(e,t){return Z.mutate(e).then((function(n){return $(n,Object(r["a"])(Object(r["a"])({},t),{},{handlerParams:{url:h,gql:e.mutation,variables:e.variables}}))}),(function(n){return ee(n,Object(r["a"])(Object(r["a"])({},t),{},{handlerParams:{url:h,gql:e.mutation,variables:e.variables}}))}))}},ie=(t["a"]=ne,function(e){var t,n,i;return null!==(t=null===e||void 0===e||null===(n=e.loc)||void 0===n||null===(i=n.source)||void 0===i?void 0:i.body)&&void 0!==t?t:"gql parse failed"})},23:function(e,t,n){"use strict";var i,r,o,a,c,s=n(8),u=n(21),l=n(20),h=(n(14),n(9)),d=(n(255),n(5)),f=(i=Object(u["a"])((function e(){Object(l["a"])(this,e),Object(s["a"])(this,"watermarkLottieUrl",r,this),Object(s["a"])(this,"watermarkVisibility",o,this),Object(s["a"])(this,"onPersonalInfoSettingSuccess",a,this),Object(s["a"])(this,"roleNames",c,this)})),r=Object(h["a"])(i.prototype,"watermarkLottieUrl",[d["m"]],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),o=Object(h["a"])(i.prototype,"watermarkVisibility",[d["m"]],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),a=Object(h["a"])(i.prototype,"onPersonalInfoSettingSuccess",[d["m"]],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=Object(h["a"])(i.prototype,"roleNames",[d["m"]],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),i);t["a"]=new f},24:function(e,t,n){"use strict";var i=n(20),r=n(21),o=n(14),a=n(10),c=n.n(a),s=n(12),u="LoginServiceAccountStorageKey",l="LoginServiceTokenStorageKey",h=function(){function e(){Object(i["a"])(this,e),Object(o["a"])(this,"account",void 0),Object(o["a"])(this,"token","eyJhbGciOiJIUzI1NiJ9.eyJyb2xlcyI6WyJhbm9ueW1vdXMiXSwiemVybyI6e30sImhhc3VyYV9jbGFpbXMiOnsieC1oYXN1cmEtZGVmYXVsdC1yb2xlIjoiYW5vbnltb3VzIiwieC1oYXN1cmEtYWxsb3dlZC1yb2xlcyI6WyJhbm9ueW1vdXMiXSwieC1oYXN1cmEtdXNlci1pZCI6IjEwMDAwMDAwMDAwMDAwMDAifSwiZGVmYXVsdFJvbGUiOiJhbm9ueW1vdXMiLCJaRVJPX1VTRVJfSUQiOiIxMDAwMDAwMDAwMDAwMDAwIn0.pDT0VY3gK_U1o4mMqP1gNejSB-eb-aLHnmJM2Ndrcwo");var t=c.a.getStorageSync(u);t&&(this.account=JSON.parse(t));var n=c.a.getStorageSync(l);n&&(this.token=n)}return Object(r["a"])(e,[{key:"isLoggedIn",value:function(){return this.getAccountId().length>0&&"1000000000000000"!==this.getAccountId()}},{key:"setAccount",value:function(e){this.account=e,e?c.a.setStorageSync(u,JSON.stringify(e)):c.a.removeStorageSync(u)}},{key:"setToken",value:function(e){this.token=e||"eyJhbGciOiJIUzI1NiJ9.eyJyb2xlcyI6WyJhbm9ueW1vdXMiXSwiemVybyI6e30sImhhc3VyYV9jbGFpbXMiOnsieC1oYXN1cmEtZGVmYXVsdC1yb2xlIjoiYW5vbnltb3VzIiwieC1oYXN1cmEtYWxsb3dlZC1yb2xlcyI6WyJhbm9ueW1vdXMiXSwieC1oYXN1cmEtdXNlci1pZCI6IjEwMDAwMDAwMDAwMDAwMDAifSwiZGVmYXVsdFJvbGUiOiJhbm9ueW1vdXMiLCJaRVJPX1VTRVJfSUQiOiIxMDAwMDAwMDAwMDAwMDAwIn0.pDT0VY3gK_U1o4mMqP1gNejSB-eb-aLHnmJM2Ndrcwo",e?c.a.setStorageSync(l,e):c.a.removeStorageSync(l)}},{key:"getAccountId",value:function(){var e=Object(s["h"])(this.account,["id"],"1000000000000000");return"number"===typeof e&&(e=JSON.stringify(e)),e}},{key:"getThirdPartyInfo",value:function(){return Object(s["h"])(this.account,["thirdPartyInfo"],{})}}]),e}(),d=new h;t["a"]=d},32:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var i,r,o,a=n(27),c=n(11),s=n(20),u=n(21),l=n(14),h=n(3),d=n.n(h),f=n(10),v=n.n(f),b=n(24),y=n(28),p=n.n(y),g=n(22),m=n(0),O=function(){function e(){Object(s["a"])(this,e),Object(l["a"])(this,"cache",{}),Object(l["a"])(this,"loadingCache",{})}return Object(u["a"])(e,[{key:"getCacheKeyFromConfig",value:function(e){return"".concat(e.id,"_").concat(e.size?"".concat(e.size.width,"_").concat(e.size.height):"default")}},{key:"getUrl",value:function(e){return this.cache[this.getCacheKeyFromConfig(e)]}},{key:"setUrl",value:function(e,t){this.cache[this.getCacheKeyFromConfig(e)]=t}},{key:"isLoading",value:function(e){var t;return(null===(t=this.loadingCache[this.getCacheKeyFromConfig(e)])||void 0===t?void 0:t.length)>0}},{key:"addLoadingCache",value:function(e,t,n){var i=this.getCacheKeyFromConfig(e),r=this.loadingCache[i];r||(r=[],this.loadingCache[i]=r),r.push({resolve:t,reject:n})}},{key:"getLoadingCache",value:function(e){return this.loadingCache[this.getCacheKeyFromConfig(e)]||[]}},{key:"clearLoadingCache",value:function(e){this.loadingCache[this.getCacheKeyFromConfig(e)]=[]}}]),e}(),k=new O,j=function(){var e=Object(c["a"])(d.a.mark((function e(t){return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var s=k.getUrl(t);if(s)e(s);else if(k.isLoading(t))k.addLoadingCache(t,e,n);else{var u;switch(k.addLoadingCache(t,e,n),t.type){case"IMAGE":u=p()(i||(i=Object(a["a"])(["\n                  query {\n                    getImageById(imageId: ",") {\n                      url","\n                    }\n                  }\n                "])),t.id,t.size?"(option: { resize: { \n      width: ".concat(Math.ceil(t.size.width*m["a"].dpr*m["a"].ratio),",\n      height: ").concat(Math.ceil(t.size.height*m["a"].dpr*m["a"].ratio),"\n    } })"):"");break;case"VIDEO":u=p()(r||(r=Object(a["a"])(["\n                  query {\n                    getVideoById(videoId: ",") {\n                      url\n                    }\n                  }\n                "])),t.id);break;case"FILE":u=p()(o||(o=Object(a["a"])(["\n                  query {\n                    getFileById(fileId: ",") {\n                      url\n                    }\n                  }\n                "])),t.id);break;default:return console.log("Unsupported resource type: ".concat(t.type)),void n("")}g["a"].query({query:u,variables:{}},{onSuccess:function(){var e=Object(c["a"])(d.a.mark((function e(n){var i,r;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=n.data,r="",e.t0=t.type,e.next="IMAGE"===e.t0?5:"VIDEO"===e.t0?7:"FILE"===e.t0?9:11;break;case 5:return r=i.getImageById.url,e.abrupt("break",13);case 7:return r=i.getVideoById.url,e.abrupt("break",13);case 9:return r=i.getFileById.url,e.abrupt("break",13);case 11:return console.log("Unsupported resource type: ".concat(t.type)),e.abrupt("break",13);case 13:k.setUrl(t,r),k.getLoadingCache(t).forEach((function(e){return e.resolve(r)})),k.clearLoadingCache(t);case 16:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}(),onFailure:function(){var e=Object(c["a"])(d.a.mark((function e(){return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:k.getLoadingCache(t).forEach((function(e){return e.reject("")})),k.clearLoadingCache(t);case 2:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}(),onShowToast:function(e){b["a"].isLoggedIn()&&v.a.showToast({title:"".concat(e),duration:1500,icon:"none"})}})}})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},34:function(e,t,n){"use strict";var i=n(36),r=n(10),o=n(2),a=n(1),c=n(4),s=function(e){var t=e.useDidShow||function(){};Object(r["useDidShow"])(t);var n=e.useEffect||function(){};Object(o["useEffect"])(n,e.useEffectDependentValues||[]);var i=e.id,s=e.style,u=e.onClick,l=e.children;return Object(c["jsx"])(a["r"],{id:i,style:s,onClick:u||function(){},children:l})};t["a"]=Object(i["a"])(s)},56:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o}));var i=new RegExp("^[-+0-9][0-9]*.?[0-9]*$"),r=(new RegExp("D"),new RegExp("^((\\+86)|(86))?[1][0-9]{10}$")),o=new RegExp("^([a-zA-Z0-9_.-])+@(([a-zA-Z0-9-])+.)+([a-zA-Z0-9]{2,4})+$")},7:function(e,t,n){"use strict";var i=n(65),r=new i["EventEmitter2"]({wildcard:!0,delimiter:"::",newListener:!1,removeListener:!1,maxListeners:999,verboseMemoryLeak:!1,ignoreErrors:!1});t["a"]=r}}]);